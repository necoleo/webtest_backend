nproc_per_node=5; CUDA_VISIBLE_DEVICES=0,1,2,3,4 NPROC_PER_NODE=$nproc_per_node swift rlhf --rlhf_type kto --model ZhipuAI/glm-4-9b-chat --train_type lora --dataset /root/data/0406/fix_train_002_lenth.jsonl --val_dataset /root/data/0406/fix_dev.jsonl --num_train_epochs 1 --per_device_train_batch_size 1 --per_device_eval_batch_size 1 --learning_rate 1e-4 --lora_rank 8 --lora_alpha 32 --target_modules all-linear --gradient_accumulation_steps $(expr 16 / $nproc_per_node) --max_steps 200 --eval_steps 50 --save_steps 50 --save_total_limit 5 --logging_steps 2 --max_length 10240 --output_dir output/api-testpilot0406 --warmup_ratio 0.05 --dataloader_num_workers 4 --deepspeed zero3 --dataset_num_proc 4 --offload_optimizer true --offload_model true --gradient_checkpointing true --resume_from_checkpoint /root/output/api-testpilot0403/v0-20250403-100422/checkpoint-200 --resume_only_model True