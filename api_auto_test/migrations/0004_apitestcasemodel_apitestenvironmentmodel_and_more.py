# Generated by Django 4.2.27 on 2026-01-19 03:12

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('api_auto_test', '0003_apidocuments_created_user_id'),
    ]

    operations = [
        migrations.CreateModel(
            name='ApiTestCaseModel',
            fields=[
                ('id', models.AutoField(db_comment='id', primary_key=True, serialize=False)),
                ('project_id', models.IntegerField(db_comment='所属项目id')),
                ('case_name', models.CharField(db_comment='用例名称', max_length=255)),
                ('description', models.TextField(blank=True, db_comment='用例描述', null=True)),
                ('cos_access_url', models.URLField(db_comment='YAML文件COS访问URL', max_length=500)),
                ('file_size', models.BigIntegerField(db_comment='文件大小（字节）', default=0)),
                ('source', models.SmallIntegerField(choices=[(0, '上传'), (1, 'AI生成')], db_comment='用例来源: 0-上传, 1-AI生成', default=0)),
                ('ai_source_interface_ids', models.JSONField(blank=True, db_comment='AI生成时关联的接口ID列表', null=True)),
                ('last_execution_status', models.SmallIntegerField(blank=True, choices=[(0, '待执行'), (1, '执行中'), (2, '成功'), (3, '失败')], db_comment='最后执行状态: 0-待执行, 1-执行中, 2-成功, 3-失败', null=True)),
                ('last_execution_time', models.DateTimeField(blank=True, db_comment='最后执行时间', null=True)),
                ('total_executions', models.IntegerField(db_comment='总执行次数', default=0)),
                ('success_count', models.IntegerField(db_comment='成功执行次数', default=0)),
                ('created_user_id', models.IntegerField(db_comment='创建人id', null=True)),
                ('created_user', models.CharField(db_comment='创建人', max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_comment='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, db_comment='更新时间')),
                ('deleted_at', models.DateTimeField(blank=True, db_comment='删除时间', null=True)),
            ],
            options={
                'verbose_name': '接口测试用例',
                'verbose_name_plural': '接口测试用例',
                'db_table': 'api_test_case',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ApiTestEnvironmentModel',
            fields=[
                ('id', models.AutoField(db_comment='id', primary_key=True, serialize=False)),
                ('project_id', models.IntegerField(db_comment='所属项目id')),
                ('env_name', models.CharField(db_comment='环境名称，如：开发环境、测试环境、生产环境', max_length=100)),
                ('description', models.TextField(blank=True, db_comment='环境描述', null=True)),
                ('base_url', models.URLField(db_comment='基础URL，如：https://api.example.com', max_length=500)),
                ('timeout', models.IntegerField(blank=True, db_comment='请求超时时间（秒）', default=30, null=True)),
                ('headers', models.JSONField(blank=True, db_comment='公共请求头，JSON格式', null=True)),
                ('variables', models.JSONField(blank=True, db_comment='环境变量，JSON格式，如：{"token": "xxx", "user_id": 123}', null=True)),
                ('is_default', models.BooleanField(db_comment='是否为默认环境', default=False)),
                ('created_user_id', models.IntegerField(db_comment='创建人id', null=True)),
                ('created_user', models.CharField(db_comment='创建人', max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_comment='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, db_comment='更新时间')),
                ('deleted_at', models.DateTimeField(blank=True, db_comment='删除时间', null=True)),
            ],
            options={
                'verbose_name': '接口测试环境配置',
                'verbose_name_plural': '接口测试环境配置',
                'db_table': 'api_test_environment',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ApiTestExecutionModel',
            fields=[
                ('id', models.AutoField(db_comment='id', primary_key=True, serialize=False)),
                ('test_case_id', models.IntegerField(db_comment='关联测试用例id')),
                ('env_id', models.IntegerField(db_comment='关联环境配置id')),
                ('status', models.SmallIntegerField(choices=[(0, '待执行'), (1, '执行中'), (2, '成功'), (3, '失败')], db_comment='执行状态: 0-待执行, 1-执行中, 2-成功, 3-失败', default=0)),
                ('trigger_type', models.SmallIntegerField(choices=[(0, '手动触发'), (1, '定时触发')], db_comment='触发类型: 0-手动触发, 1-定时触发', default=0)),
                ('scheduled_task_id', models.IntegerField(blank=True, db_comment='关联定时任务id', null=True)),
                ('celery_task_id', models.CharField(blank=True, db_comment='Celery任务id', max_length=100, null=True)),
                ('total_cases', models.IntegerField(blank=True, db_comment='总用例数', default=0, null=True)),
                ('passed_cases', models.IntegerField(blank=True, db_comment='通过用例数', default=0, null=True)),
                ('failed_cases', models.IntegerField(blank=True, db_comment='失败用例数', default=0, null=True)),
                ('pass_rate', models.DecimalField(blank=True, db_comment='通过率（百分比）', decimal_places=2, max_digits=5, null=True)),
                ('report_url', models.URLField(blank=True, db_comment='测试报告COS访问URL', max_length=500, null=True)),
                ('error_message', models.TextField(blank=True, db_comment='错误信息', null=True)),
                ('started_at', models.DateTimeField(blank=True, db_comment='开始执行时间', null=True)),
                ('finished_at', models.DateTimeField(blank=True, db_comment='执行完成时间', null=True)),
                ('duration', models.IntegerField(blank=True, db_comment='执行耗时（秒）', null=True)),
                ('executed_user_id', models.IntegerField(db_comment='执行人id', null=True)),
                ('executed_user', models.CharField(db_comment='执行人', max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_comment='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, db_comment='更新时间')),
            ],
            options={
                'verbose_name': '接口测试执行记录',
                'verbose_name_plural': '接口测试执行记录',
                'db_table': 'api_test_execution',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ApiTestScheduleModel',
            fields=[
                ('id', models.AutoField(db_comment='id', primary_key=True, serialize=False)),
                ('project_id', models.IntegerField(db_comment='所属项目id')),
                ('task_name', models.CharField(db_comment='任务名称', max_length=255)),
                ('description', models.TextField(blank=True, db_comment='任务描述', null=True)),
                ('test_case_id', models.IntegerField(db_comment='关联测试用例id')),
                ('env_id', models.IntegerField(db_comment='关联环境配置id')),
                ('schedule_type', models.SmallIntegerField(choices=[(0, '每天'), (1, '每周')], db_comment='调度类型: 0-每天, 1-每周', default=0)),
                ('schedule_time', models.TimeField(db_comment='执行时间')),
                ('schedule_weekday', models.IntegerField(blank=True, db_comment='执行星期（1-7，周一到周日）', null=True)),
                ('is_enabled', models.BooleanField(db_comment='是否启用', default=True)),
                ('last_execution_time', models.DateTimeField(blank=True, db_comment='上次执行时间', null=True)),
                ('last_execution_status', models.SmallIntegerField(blank=True, choices=[(0, '待执行'), (1, '执行中'), (2, '成功'), (3, '失败')], db_comment='上次执行状态: 0-待执行, 1-执行中, 2-成功, 3-失败', null=True)),
                ('next_execution_time', models.DateTimeField(blank=True, db_comment='下次执行时间', null=True)),
                ('created_user_id', models.IntegerField(db_comment='创建人id', null=True)),
                ('created_user', models.CharField(db_comment='创建人', max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_comment='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, db_comment='更新时间')),
                ('deleted_at', models.DateTimeField(blank=True, db_comment='删除时间', null=True)),
            ],
            options={
                'verbose_name': '接口测试定时任务',
                'verbose_name_plural': '接口测试定时任务',
                'db_table': 'api_test_schedule',
                'ordering': ['-created_at'],
            },
        ),
    ]
